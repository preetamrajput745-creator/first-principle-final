[
    {
        "id": null,
        "title": "Time Drift & Normalization",
        "timezone": "browser",
        "panels": [
            {
                "title": "Drift Heatmap (Source vs Server)",
                "type": "heatmap",
                "targets": [
                    {
                        "expr": "sum(rate(time_normalizer_drift_ms_bucket[5m])) by (le)"
                    }
                ]
            },
            {
                "title": "Clock skew > 100ms (Violation)",
                "type": "stat",
                "targets": [
                    {
                        "expr": "time_normalizer_drift_ms_gauge > 100"
                    }
                ],
                "thresholds": {
                    "steps": [
                        {
                            "color": "green",
                            "value": null
                        },
                        {
                            "color": "red",
                            "value": 1
                        }
                    ]
                }
            },
            {
                "title": "Normalization Latency (p99)",
                "type": "timeseries",
                "targets": [
                    {
                        "expr": "histogram_quantile(0.99, rate(time_normalizer_latency_ms_bucket[1m]))"
                    }
                ]
            }
        ]
    }
]